{% extends 'base.html.twig' %}

{% block title %}دورهمی | جامعه توسعه‌دهندگان نرم‌افزار{% endblock %}

{% block body %}
    <div class="max-w-6xl mx-auto">
        {% for type, messages in app.flashes %}
            {% for message in messages %}
                <div class="mb-4 p-4 rounded-md {% if type == 'success' %}bg-green-50 text-green-800{% else %}bg-red-50 text-red-800{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}

        <section class="py-12">
            <div class="text-center">
                <h1 class="text-4xl font-bold mb-4">دورهمی، برای برنامه‌نویس‌ها</h1>
                <p class="text-lg max-w-3xl mx-auto mb-8">
                    یه جامعه‌ی کوچیک از برنامه‌نویس‌های فارسی زبان تو دیسکورد. یه جایی که میتونی، بر عکس کانال‌های
                    تلگرامی، سریع و راحت جواب همه‌ی سوالاتت رو پیدا کنی و با بقیه برنامه‌نویس‌های فارسی زبان آشنا بشی.
                </p>
            </div>
        </section>

        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <h2 class="text-xl font-semibold text-primary-800 mb-2">جامعه دیسکورد دورهمی</h2>
                    <p class="text-gray-600">محیطی برای گفتگو و یادگیری توسعه نرم‌افزار</p>
                </div>
                <div class="flex flex-col items-center">
                    <div class="flex items-center mb-2">
                        <svg class="w-5 h-5 text-primary-600 ml-2" xmlns="http://www.w3.org/2000/svg" fill="none"
                             viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"/>
                        </svg>
                        <span class="text-2xl font-bold text-primary-800">{{ discord_info.total_members|persian_number }}</span>
                        <span class="text-primary-500 mr-2">کاربر</span>
                    </div>
                    <a href="{{ path('redirect_invite') }}"
                       class="inline-flex items-center py-2 px-4 rounded bg-primary-600 text-white hover:bg-primary-700 transition duration-200">
                        <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/>
                        </svg>
                        پیوستن به دیسکورد
                    </a>
                </div>
            </div>
        </div>

        <section class="py-12">
            <div class="text-center mb-12">
                <h2 class="text-2xl font-bold mb-2">دورهمی چیه؟ کجاست؟</h2>
                <h3 class="text-lg mb-4">یه جامعه‌ی کوچیک در حال رشد از برنامه‌نویس‌های ایرانی</h3>
                <p class="max-w-4xl mx-auto text-sm">
                    دورهمی با این ایده تشکیل شده، که بتونه به عنوان یک <strong>شبکه‌ی اجتماعی ساده</strong>،
                    برنامه‌نویس‌های ایرانی رو از همه‌ی جای دنیا گرد هم بیاره، فضای مشارکتی و گروهی رو فراهم کنه و تا
                    جایی که ممکنه به برنامه‌نویس‌های تازه‌کار کمک کنه به منابع مفید و بروز دسترسی پیدا کنن. و همه‌ی
                    اینها رو توی <strong>یکجا</strong> کنار هم بیاره.
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white rounded-lg p-6">
                    <div class="mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-primary-600 mx-auto" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">سوالات فنی</h3>
                    <p class="text-sm">
                        سوالی برات پیش اومده؟ جایی به مشکل خوردی و نمیتونی حلش کنی؟ به جای اینکه توی تلگرام پیام بذاری
                        تا شاید کسی جواب بده، تو دورهمی میتونی از متخصص‌ها سریع جواب بگیری، و تو جواب‌های قبلی به سادگی
                        جست‌وجو کنی!
                    </p>
                </div>

                <div class="bg-white rounded-lg p-6">
                    <div class="mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-primary-600 mx-auto" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">رویدادهای مختلف</h3>
                    <p class="text-sm">
                        از رویدادهای مختلف برنامه‌نویس عقب نمون! اگر جایی جلسه‌ای باشه، یه رویدادی تو یه جای ایران و
                        دنیا بخواد برگزار بشه، تو یه نقطه‌ی شهر بچه‌ها بخوان دور هم جمع بشن و در مورد یه تکنولوژی یا
                        چیزی صحبت کنن، تو هم میتونی بخشی ازش باشی.
                    </p>
                </div>

                <div class="bg-white rounded-lg p-6">
                    <div class="mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-primary-600 mx-auto" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">پروموشن پست‌‌های بلاگ</h3>
                    <p class="text-sm">
                        تو هم علاقه به مطلب نوشتن داری؟ دنبال یه جایی میگردی که مطالبت رو به دست خواننده‌ها برسونی؟
                        دورهمی بهترین جا برای توست! تو دورهمی یه کانال مجزا فقط برای پروموت کردن نوشته‌های بروبچه‌های
                        وبلاگ‌دار گذاشته شده که بتونن ساده پست‌هاشون رو به اشتراک بذارن و خواننده جمع کنن.
                    </p>
                </div>

                <div class="bg-white rounded-lg p-6">
                    <div class="mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-primary-600 mx-auto" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">Pair Programming</h3>
                    <p class="text-sm">
                        دنبال کسی هستی تا کنارش بتونی کد بزنی؟ دوست داری به چند نفر آموزش بدی؟ به جای اینکه تو چندین
                        پلتفرم مختلف بری و عضو بشی، کافیه توی دورهمی یه اتاق رزرو کنی و از ۲ تا ۱۰ نفر رو کنار هم جمع
                        کنی! میتونی با بقیه کد بزنی، سخنرانی کنی و با دوستاتون بازی کنی!
                    </p>
                </div>

                <div class="bg-white rounded-lg p-6">
                    <div class="mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-primary-600 mx-auto" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">موقعیت‌های شغلی</h3>
                    <p class="text-sm">
                        دنبال کار هستی یا یه پوزیشن خالی داری؟ چه جایی بهتر از یه جامعه پر از برنامه‌نویس‌های خوب و
                        علاقمند به کار شرکت‌هایی که دقیقا دنبال کسایی مثل تو میگردن؟ چه جایی بهتر از یه دورهمی
                        برنامه‌نویسی؟
                    </p>
                </div>

                <div class="bg-primary-600 rounded-lg p-6 text-white">
                    <div class="mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white mx-auto" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">به ما بپیوندید</h3>
                    <p class="mb-4 text-sm">
                        همین الان به جامعه برنامه‌نویسی دورهمی بپیوندید و از مزایای آن بهره‌مند شوید!
                    </p>
                    <div class="text-center">
                        <a href="{{ path('redirect_invite') }}"
                           class="inline-block bg-white text-primary-600 hover:bg-gray-100 px-6 py-3 rounded-md font-bold">
                            پیوست به دیسکورد
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <div class="flex justify-between items-center mb-4 mt-8">
            <h1 class="text-2xl font-bold">مطالب جدید</h1>
            <div class="flex space-x-2 space-x-reverse items-center gap-2">
                <a href="{{ path('app_home', {'filter': 'newest'}) }}"
                   class="px-3 py-1 rounded text-sm {% if filter == 'newest' %}text-primary-600 bg-primary-50{% else %}text-gray-600 hover:bg-gray-100{% endif %} transition">جدیدترین</a>
                <a href="{{ path('app_home', {'filter': 'popular'}) }}"
                   class="px-3 py-1 rounded text-sm {% if filter == 'popular' %}text-primary-600 bg-primary-50{% else %}text-gray-600 hover:bg-gray-100{% endif %} transition">محبوب‌ترین</a>
                {% if is_granted('ROLE_USER') %}
                    <a href="{{ path('app_post_new') }}"
                       class="inline-flex items-center py-1 px-2 rounded bg-primary-600 text-white text-sm hover:bg-primary-700 transition duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20"
                             fill="currentColor">
                            <path fill-rule="evenodd"
                                  d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z"
                                  clip-rule="evenodd"/>
                        </svg>
                        ارسال مطلب جدید
                    </a>
                {% endif %}
            </div>
        </div>

        <div class="bg-white rounded-lg">
            <ul class="divide-y divide-gray-200">
                {% if posts|length > 0 %}
                    {% for post in posts %}
                        <li class="py-4 px-4 hover:bg-gray-50 transition">
                            <div class="flex">
                                <div class="flex-1">
                                    <div class="flex flex-col md:flex-row md:items-baseline">
                                        <a href="{{ path('app_post_show', {'id': post.id}) }}"
                                           class="text-lg font-medium text-gray-900 hover:text-primary-600">
                                            {{ post.title }}
                                        </a>
                                        <span class="text-xs text-gray-500 md:mr-2">({{ post.domain }})</span>
                                    </div>

                                    <!-- Meta information -->
                                    <div class="mt-1 text-xs text-gray-500 flex">
                                        <span>{{ post.points|persian_number }} امتیاز</span>
                                        <span class="mx-1">•</span>
                                        <span>{{ post.author.displayName }}</span>
                                        <span class="mx-1">•</span>
                                        <span>
                                            {{ post.createdAt|persian_ago }}
                                        </span>
                                        <span class="mx-1">•</span>
                                        <a href="{{ path('app_post_show', {'id': post.id}) }}"
                                           class="text-primary-600 hover:text-primary-800">
                                            {{ post.comments|length|persian_number }} دیدگاه
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </li>
                    {% endfor %}
                {% else %}
                    <li class="py-8 text-center text-gray-500">
                        هنوز مطلبی ارسال نشده است.
                        {% if is_granted('ROLE_USER') %}
                            <a href="{{ path('app_post_new') }}" class="text-primary-600 hover:text-primary-800">اولین
                                مطلب را ارسال کنید!</a>
                        {% endif %}
                    </li>
                {% endif %}
            </ul>
        </div>

        {% if posts|length > 0 %}
            <div class="mt-8 flex justify-center">
                <nav class="inline-flex rounded">
                    {% if pagination.has_previous %}
                        <a href="{{ path('app_home', {'filter': filter, 'page': pagination.previous_page}) }}"
                           class="px-3 py-2 text-gray-700 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50">قبلی</a>
                    {% else %}
                        <span class="px-3 py-2 text-gray-400 bg-white border border-gray-300 rounded-r-md cursor-not-allowed">قبلی</span>
                    {% endif %}

                    {% for i in 1..pagination.last_page %}
                        {% if i == pagination.current_page %}
                            <a href="{{ path('app_home', {'filter': filter, 'page': i}) }}"
                               class="px-3 py-2 text-white bg-primary-600 border border-primary-600">{{ i|persian_number }}</a>
                        {% else %}
                            <a href="{{ path('app_home', {'filter': filter, 'page': i}) }}"
                               class="px-3 py-2 text-gray-700 bg-white border border-gray-300 hover:bg-gray-50">{{ i|persian_number }}</a>
                        {% endif %}
                    {% endfor %}

                    {% if pagination.has_next %}
                        <a href="{{ path('app_home', {'filter': filter, 'page': pagination.next_page}) }}"
                           class="px-3 py-2 text-gray-700 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50">بعدی</a>
                    {% else %}
                        <span class="px-3 py-2 text-gray-400 bg-white border border-gray-300 rounded-l-md cursor-not-allowed">بعدی</span>
                    {% endif %}
                </nav>
            </div>
        {% endif %}
    </div>
{% endblock %}